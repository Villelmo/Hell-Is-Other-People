<% include header.html %>

<script>

$(document).ready( function() {


	var bounds = [
		{x:40.682949,y:-74.047852},
		{x:40.881989,y:-73.906693}
	];

	var mapContext = $('#mapCanvas')[0].getContext('2d');

	$.ajax({
		url: '/json/',
		success: function(data) {
			console.log(data);

			$(data).each(function(index,value) {	


				// 12589342
				// -74.047852, 40.682949, -73.906693 , 40.881989

				var imageNorthLat=bounds[0].x;
				var imageSouthLat=bounds[1].x

				var imageWestLong=bounds[0].y;
				var imageEastLong=bounds[1].y;

				var imageLongPixels = mapContext.canvas.width;
				var imageLatPixels = mapContext.canvas.height;

				var pixelsPerLat=imageLatPixels/(imageNorthLat-imageSouthLat);
				var pixelsPerLong=imageLongPixels/(imageEastLong-imageWestLong);

				var x = (value.location_lng-imageWestLong)*pixelsPerLong;
				var y = imageLatPixels + (value.location_lat-imageNorthLat)*pixelsPerLat;


				console.log(x + "," + y);


		      mapContext.beginPath();
		      mapContext.arc(x-4, y-4, 4, 0, 2 * Math.PI, false);
		      mapContext.fillStyle = '#6699cc';
		      mapContext.fill();
		      mapContext.lineWidth = .1;
		      mapContext.strokeStyle = '#003300';
		      mapContext.stroke();				

			})


		}
	});

});

function asinh (arg) {
  // http://kevin.vanzonneveld.net
  // +   original by: Onno Marsman
  // *     example 1: asinh(8723321.4);
  // *     returns 1: 16.67465779841863
  return Math.log(arg + Math.sqrt(arg * arg + 1));
}

function deg2rad (angle) {
  // http://kevin.vanzonneveld.net
  // +   original by: Enrique Gonzalez
  // +     improved by: Thomas Grainger (http://graingert.co.uk)
  // *     example 1: deg2rad(45);
  // *     returns 1: 0.7853981633974483
  return (angle / 180) * Math.PI;
}

</script>

<div id="map">
<img id="mapImage" src="https://dl.dropboxusercontent.com/u/4510579/2013/hellisotherpeople/map.png" width="268" height="499"/>
<canvas id="mapCanvas" width="268" height="499"/>
</div>

<% include footer.html %>